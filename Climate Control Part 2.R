# Climate Control Part #2
# Much of the following code was provided by Dr. Grimshaw
#Data on Temp
temp <- read.table(header=TRUE, text="
                   Year   Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec    J-D D-N    DJF  MAM  JJA  SON  Year
                   1969   -10  -14    1   18   19    5   -2    3    9   13   13   28      7   3    -12   13    2   12  1969
                   1970     9   22    8    9   -4   -2   -2   -9   11    6    2  -12      3   7     20    4   -4    6  1970
                   1971    -2  -20  -17   -8   -5  -19  -11   -3   -4   -6   -5   -9     -9  -9    -11  -10  -11   -5  1971
                   1972   -24  -16    2    0   -4    6    1   17    2    9    4   19      1  -1    -16    0    8    5  1972
                   1973    29   31   27   26   25   17   10    3   10   14    6   -6     16  18     26   26   10   10  1973
                   1974   -15  -29   -6  -12   -2   -6   -5   11  -12   -8   -7   -9     -8  -8    -16   -7    0   -9  1974
                   1975     7    6   13    5   16    0   -1  -19   -3   -9  -16  -17     -2  -1      1   11   -7   -9  1975
                   1976    -2   -6  -21   -8  -24  -16  -10  -14   -9  -26   -4   10    -11 -13     -8  -18  -13  -13  1976
                   1977    19   22   24   27   30   24   20   16    0    2   17    2     17  18     17   27   20    6  1977
                   1978     6   14   21   15    6   -2    3  -18    5    0   15   10      6   6      7   14   -6    7  1978
                   1979    12  -10   18   13    5   13    2   13   25   24   28   47     16  13      4   12   10   26  1979
                   1980    30   43   30   33   36   17   28   23   19   18   29   19     27  29     40   33   23   22  1980
                   1981    55   41   49   31   24   31   34   32   16   14   24   43     33  31     38   35   32   18  1981
                   1982    10   16   -1    9   16    5   13    7   14   13   15   42     13  13     23    8    8   14  1982
                   1983    52   40   42   31   36   20   17   33   39   16   32   17     31  33     45   36   23   29  1983
                   1984    30   17   29    8   33    5   17   16   21   16    6   -5     16  18     21   23   13   14  1984
                   1985    22   -6   17   11   17   18   -1   15   15   12    9   15     12  10      4   15   11   12  1985
                   1986    29   38   28   24   24   11   11   12    0   13   11   16     18  18     27   25   11    8  1986
                   1987    36   45   16   22   25   37   45   28   39   32   25   47     33  30     32   21   36   32  1987
                   1988    57   43   51   45   43   43   34   47   41   39   12   33     41  42     49   46   41   31  1988
                   1989    15   35   37   33   16   14   33   37   37   32   20   38     29  29     27   29   28   30  1989
                   1990    40   41   76   55   46   38   43   30   29   41   45   40     44  44     40   59   37   38  1990
                   1991    40   49   34   52   37   52   47   39   48   30   31   32     41  42     43   41   46   36  1991
                   1992    44   41   47   23   32   25   12    7    0    8    2   21     22  23     39   34   15    4  1992
                   1993    37   38   36   27   27   25   28   13   10   22    6   16     24  24     32   30   22   13  1993
                   1994    27    2   27   40   28   43   31   21   29   41   46   36     31  29     15   32   31   39  1994
                   1995    50   78   45   47   26   41   47   46   33   47   45   28     44  45     55   39   45   42  1995
                   1996    25   48   32   36   27   25   36   48   25   19   41   40     33  32     34   32   36   28  1996
                   1997    31   38   53   36   36   54   35   41   53   62   64   59     47  45     36   42   43   60  1997
                   1998    60   90   63   63   69   77   68   66   41   44   49   56     62  62     69   65   70   45  1998
                   1999    48   65   34   33   31   37   37   31   41   39   38   43     40  41     56   33   35   39  1999
                   2000    24   56   58   57   36   41   39   42   41   28   32   29     40  41     41   50   41   34  2000
                   2001    42   44   56   51   57   54   60   48   54   51   70   56     54  51     38   55   54   58  2001
                   2002    75   75   90   57   63   55   61   53   63   55   58   44     62  63     69   70   56   59  2002
                   2003    72   55   57   54   61   48   54   65   65   74   53   73     61  58     57   57   56   64  2003
                   2004    58   73   64   63   40   43   24   44   50   63   71   48     53  56     68   56   37   61  2004
                   2005    70   55   71   68   63   66   64   61   75   76   72   65     67  66     58   67   64   74  2005
                   2006    56   68   62   50   47   64   52   70   62   67   69   73     62  61     63   53   62   66  2006
                   2007    94   70   69   74   66   58   60   57   60   57   55   46     64  66     79   69   58   57  2007
                   2008    23   34   73   51   47   45   59   43   63   63   65   53     52  51     34   57   49   64  2008
                   2009    61   50   52   59   65   65   70   66   68   64   76   66     63  62     55   59   67   69  2009
                   2010    73   80   92   85   73   62   59   63   59   69   78   46     70  71     73   83   62   68  2010
                   2011    49   51   62   62   50   56   71   71   54   63   55   53     58  57     48   58   66   57  2011
                   2012    45   47   56   67   74   62   54   60   72   75   74   52     61  61     48   66   59   73  2012
                   2013    66   55   66   52   57   65   57   65   76   67   78   65     64  63     58   58   63   74  2013
                   2014    73   52   76   77   85   66   56   80   88   81   66   78     73  72     63   79   67   78  2014
                   2015    81   87   90   74   75   79   71   79   81  107  102  110     86  84     82   80   76   97  2015
                   2016   115  134  130  107   90   78   82   99   87   89   90   82     99 101    119  109   86   88  2016
                   2017    96  111  113   93   88   70   81   86   74   88   87   89     90  89     96   98   79   83  2017")

temp <- temp[,1:13]
newtemp<-data.frame(temp=matrix(t(temp[2:13]),ncol=1))
newtemp$month<-rep(1:12,49)
newtemp$year<-rep(1969:2017,each=12)

#CO2 Data
#obtained at ftp://aftp.cmdl.noaa.gov/data/trace_gases/co2/flask/surface/co2_mlo_surface-flask_1_ccgg_month.txt
# in Feb 2018
maunaloa1<-read.table(header=TRUE,text="
                      where year month co2
                      MLO 1969  8   322.51
                      MLO 1969  9   321.36
                      MLO 1969 10   320.74
                      MLO 1969 11   321.98
                      MLO 1969 12   323.78
                      MLO 1970  1   325.13
                      MLO 1970  2   325.54
                      MLO 1970  3   325.68
                      MLO 1970  4   326.58
                      MLO 1970  5   327.68
                      MLO 1970  6   327.30
                      MLO 1970  7   326.13
                      MLO 1970  8   324.91
                      MLO 1970  9   322.98
                      MLO 1970 10   322.64
                      MLO 1970 11   324.03
                      MLO 1970 12   325.54
                      MLO 1976  7   332.30
                      MLO 1976  8   331.04
                      MLO 1976  9   329.67
                      MLO 1976 10   329.33
                      MLO 1976 11   330.46
                      MLO 1976 12   331.97
                      MLO 1977  1   332.77
                      MLO 1977  2   333.10
                      MLO 1977  3   334.08
                      MLO 1977  4   335.78
                      MLO 1977  5   336.49
                      MLO 1977  6   335.96
                      MLO 1977  7   334.64
                      MLO 1977  8   332.31
                      MLO 1977  9   330.66
                      MLO 1977 10   330.55
                      MLO 1977 11   331.72
                      MLO 1977 12   333.74
                      MLO 1978  1   335.17
                      MLO 1978  2   335.78
                      MLO 1978  3   336.69
                      MLO 1978  4   337.76
                      MLO 1978  5   338.01
                      MLO 1978  6   337.57
                      MLO 1978  7   336.17
                      MLO 1978  8   333.89
                      MLO 1978  9   332.19
                      MLO 1978 10   332.20
                      MLO 1978 11   333.24
                      MLO 1978 12   334.64
                      MLO 1979  1   336.12
                      MLO 1979  2   337.20
                      MLO 1979  3   338.50
                      MLO 1979  4   339.00
                      MLO 1979  5   338.93
                      MLO 1979  6   338.97
                      MLO 1979  7   337.78
                      MLO 1979  8   335.57
                      MLO 1979  9   333.95
                      MLO 1979 10   334.41
                      MLO 1979 11   335.66
                      MLO 1979 12   336.81
                      MLO 1980  1   338.87
                      MLO 1980  2   340.17
                      MLO 1980  3   341.33
                      MLO 1980  4   342.82
                      MLO 1980  5   342.90
                      MLO 1980  6   341.74
                      MLO 1980  7   339.16
                      MLO 1980  8   337.04
                      MLO 1980  9   336.60
                      MLO 1980 10   336.60
                      MLO 1980 11   337.55
                      MLO 1980 12   339.18
                      MLO 1981  1   340.41
                      MLO 1981  2   341.39
                      MLO 1981  3   342.33
                      MLO 1981  4   343.35
                      MLO 1981  5   343.56
                      MLO 1981  6   342.34
                      MLO 1981  7   340.40
                      MLO 1981  8   338.67
                      MLO 1981  9   337.37
                      MLO 1981 10   337.53
                      MLO 1981 11   338.88
                      MLO 1981 12   340.21
                      MLO 1982  1   341.10
                      MLO 1982  2   341.99
                      MLO 1982  3   343.03
                      MLO 1982  4   343.82
                      MLO 1982  5   343.76
                      MLO 1982  6   342.87
                      MLO 1982  7   341.47
                      MLO 1982  8   339.26
                      MLO 1982  9   337.33
                      MLO 1982 10   337.64
                      MLO 1982 11   339.03
                      MLO 1982 12   340.66
                      MLO 1983  1   341.96
                      MLO 1983  2   342.37
                      MLO 1983  3   343.11
                      MLO 1983  4   345.12
                      MLO 1983  5   346.09
                      MLO 1983  6   345.30
                      MLO 1983  7   343.53
                      MLO 1983  8   341.20
                      MLO 1983  9   339.78
                      MLO 1983 10   339.98
                      MLO 1983 11   341.14
                      MLO 1983 12   342.73
                      MLO 1984  1   343.94
                      MLO 1984  2   344.59
                      MLO 1984  3   345.52
                      MLO 1984  4   346.81
                      MLO 1984  5   347.38
                      MLO 1984  6   346.62
                      MLO 1984  7   345.10
                      MLO 1984  8   342.86
                      MLO 1984  9   341.30
                      MLO 1984 10   341.70
                      MLO 1984 11   343.00
                      MLO 1984 12   343.92
                      MLO 1985  1   344.60
                      MLO 1985  2   345.65
                      MLO 1985  3   346.86
                      MLO 1985  4   347.80
                      MLO 1985  5   348.57
                      MLO 1985  6   348.19
                      MLO 1985  7   346.22
                      MLO 1985  8   343.94
                      MLO 1985  9   342.83
                      MLO 1985 10   342.87
                      MLO 1985 11   344.05
                      MLO 1985 12   345.31
                      MLO 1986  1   346.10
                      MLO 1986  2   346.61
                      MLO 1986  3   347.69
                      MLO 1986  4   349.29
                      MLO 1986  5   349.94
                      MLO 1986  6   349.06
                      MLO 1986  7   347.06
                      MLO 1986  8   345.26
                      MLO 1986  9   344.05
                      MLO 1986 10   343.81
                      MLO 1986 11   345.37
                      MLO 1986 12   346.84
                      MLO 1987  1   347.51
                      MLO 1987  2   348.25
                      MLO 1987  3   349.26
                      MLO 1987  4   350.75
                      MLO 1987  5   351.77
                      MLO 1987  6   351.40
                      MLO 1987  7   349.62
                      MLO 1987  8   347.48
                      MLO 1987  9   346.45
                      MLO 1987 10   346.81
                      MLO 1987 11   348.11
                      MLO 1987 12   349.42
                      MLO 1988  1   350.28
                      MLO 1988  2   351.35
                      MLO 1988  3   352.52
                      MLO 1988  4   353.72
                      MLO 1988  5   354.35
                      MLO 1988  6   353.83
                      MLO 1988  7   352.34
                      MLO 1988  8   350.12
                      MLO 1988  9   348.78
                      MLO 1988 10   349.12
                      MLO 1988 11   350.14
                      MLO 1988 12   351.61
                      MLO 1989  1   352.74
                      MLO 1989  2   353.14
                      MLO 1989  3   353.96
                      MLO 1989  4   355.54
                      MLO 1989  5   356.16
                      MLO 1989  6   355.45
                      MLO 1989  7   354.00
                      MLO 1989  8   351.37
                      MLO 1989  9   349.51
                      MLO 1989 10   349.90
                      MLO 1989 11   351.53
                      MLO 1989 12   352.88
                      MLO 1990  1   354.02
                      MLO 1990  2   355.11
                      MLO 1990  3   355.90
                      MLO 1990  4   356.71
                      MLO 1990  5   357.17
                      MLO 1990  6   356.32
                      MLO 1990  7   354.53
                      MLO 1990  8   352.44
                      MLO 1990  9   351.21
                      MLO 1990 10   351.52
                      MLO 1990 11   353.10
                      MLO 1990 12   354.66
                      MLO 1991  1   355.24
                      MLO 1991  2   356.09
                      MLO 1991  3   357.54
                      MLO 1991  4   358.68
                      MLO 1991  5   359.34
                      MLO 1991  6   358.28
                      MLO 1991  7   355.86
                      MLO 1991  8   353.82
                      MLO 1991  9   352.42
                      MLO 1991 10   352.53
                      MLO 1991 11   354.00
                      MLO 1991 12   355.44
                      MLO 1992  1   356.64
                      MLO 1992  2   357.29
                      MLO 1992  3   358.12
                      MLO 1992  4   359.17
                      MLO 1992  5   359.94
                      MLO 1992  6   359.48
                      MLO 1992  7   357.17
                      MLO 1992  8   355.02
                      MLO 1992  9   353.69
                      MLO 1992 10   353.56
                      MLO 1992 11   354.63
                      MLO 1992 12   355.97
                      MLO 1993  1   356.81
                      MLO 1993  2   357.39
                      MLO 1993  3   358.25
                      MLO 1993  4   359.56
                      MLO 1993  5   360.47
                      MLO 1993  6   359.69
                      MLO 1993  7   357.74
                      MLO 1993  8   355.54
                      MLO 1993  9   353.84
                      MLO 1993 10   354.20
                      MLO 1993 11   355.41
                      MLO 1993 12   356.90
                      MLO 1994  1   358.28
                      MLO 1994  2   358.86
                      MLO 1994  3   359.69
                      MLO 1994  4   361.04
                      MLO 1994  5   361.73
                      MLO 1994  6   360.83
                      MLO 1994  7   358.93
                      MLO 1994  8   356.94
                      MLO 1994  9   355.33
                      MLO 1994 10   355.55
                      MLO 1994 11   357.49
                      MLO 1994 12   359.57
                      MLO 1995  1   360.24
                      MLO 1995  2   360.61
                      MLO 1995  3   361.82
                      MLO 1995  4   362.93
                      MLO 1995  5   363.63
                      MLO 1995  6   363.28
                      MLO 1995  7   361.36
                      MLO 1995  8   359.17
                      MLO 1995  9   358.04
                      MLO 1995 10   358.09
                      MLO 1995 11   359.44
                      MLO 1995 12   361.02
                      MLO 1996  1   362.10
                      MLO 1996  2   363.20
                      MLO 1996  3   364.18
                      MLO 1996  4   364.81
                      MLO 1996  5   365.35
                      MLO 1996  6   365.13
                      MLO 1996  7   363.51
                      MLO 1996  8   361.13
                      MLO 1996  9   359.30
                      MLO 1996 10   359.38
                      MLO 1996 11   360.92
                      MLO 1996 12   362.02
                      MLO 1997  1   363.07
                      MLO 1997  2   363.89
                      MLO 1997  3   364.91
                      MLO 1997  4   366.56
                      MLO 1997  5   366.66
                      MLO 1997  6   365.49
                      MLO 1997  7   364.09
                      MLO 1997  8   362.15
                      MLO 1997  9   360.50
                      MLO 1997 10   360.71
                      MLO 1997 11   362.52
                      MLO 1997 12   364.16
                      MLO 1998  1   365.26
                      MLO 1998  2   366.04
                      MLO 1998  3   367.12
                      MLO 1998  4   368.65
                      MLO 1998  5   369.39
                      MLO 1998  6   368.98
                      MLO 1998  7   367.74
                      MLO 1998  8   365.74
                      MLO 1998  9   364.13
                      MLO 1998 10   364.14
                      MLO 1998 11   365.60
                      MLO 1998 12   367.52
                      MLO 1999  1   368.36
                      MLO 1999  2   368.63
                      MLO 1999  3   369.76
                      MLO 1999  4   370.89
                      MLO 1999  5   370.89
                      MLO 1999  6   370.42
                      MLO 1999  7   369.14
                      MLO 1999  8   366.95
                      MLO 1999  9   365.12
                      MLO 1999 10   365.43
                      MLO 1999 11   366.82
                      MLO 1999 12   368.36
                      MLO 2000  1   369.62
                      MLO 2000  2   370.13
                      MLO 2000  3   370.85
                      MLO 2000  4   371.81
                      MLO 2000  5   371.90
                      MLO 2000  6   371.38
                      MLO 2000  7   370.07
                      MLO 2000  8   368.11
                      MLO 2000  9   366.89
                      MLO 2000 10   367.14
                      MLO 2000 11   368.37
                      MLO 2000 12   369.61
                      MLO 2001  1   370.73
                      MLO 2001  2   371.81
                      MLO 2001  3   372.84
                      MLO 2001  4   373.69
                      MLO 2001  5   374.18
                      MLO 2001  6   373.36
                      MLO 2001  7   371.35
                      MLO 2001  8   369.41
                      MLO 2001  9   368.18
                      MLO 2001 10   368.45
                      MLO 2001 11   370.13
                      MLO 2001 12   371.43
                      MLO 2002  1   372.18
                      MLO 2002  2   372.94
                      MLO 2002  3   373.92
                      MLO 2002  4   374.80
                      MLO 2002  5   375.51
                      MLO 2002  6   375.55
                      MLO 2002  7   373.86
                      MLO 2002  8   371.19
                      MLO 2002  9   369.72
                      MLO 2002 10   370.45
                      MLO 2002 11   372.40
                      MLO 2002 12   373.65
                      MLO 2003  1   374.63
                      MLO 2003  2   375.77
                      MLO 2003  3   376.81
                      MLO 2003  4   378.08
                      MLO 2003  5   378.88
                      MLO 2003  6   378.26
                      MLO 2003  7   376.52
                      MLO 2003  8   374.53
                      MLO 2003  9   372.95
                      MLO 2003 10   373.13
                      MLO 2003 11   374.84
                      MLO 2003 12   376.03
                      MLO 2004  1   376.85
                      MLO 2004  2   377.81
                      MLO 2004  3   379.46
                      MLO 2004  4   380.74
                      MLO 2004  5   380.78
                      MLO 2004  6   379.62
                      MLO 2004  7   377.37
                      MLO 2004  8   375.56
                      MLO 2004  9   374.23
                      MLO 2004 10   374.54
                      MLO 2004 11   376.24
                      MLO 2004 12   377.61
                      MLO 2005  1   378.58
                      MLO 2005  2   380.19
                      MLO 2005  3   381.75
                      MLO 2005  4   382.15
                      MLO 2005  5   382.49
                      MLO 2005  6   382.25
                      MLO 2005  7   380.80
                      MLO 2005  8   378.62
                      MLO 2005  9   376.79
                      MLO 2005 10   377.05
                      MLO 2005 11   378.65
                      MLO 2005 12   380.10
                      MLO 2006  1   381.22
                      MLO 2006  2   381.92
                      MLO 2006  3   382.84
                      MLO 2006  4   384.73
                      MLO 2006  5   385.42
                      MLO 2006  6   384.06
                      MLO 2006  7   382.30
                      MLO 2006  8   380.06
                      MLO 2006  9   378.71
                      MLO 2006 10   379.11
                      MLO 2006 11   380.39
                      MLO 2006 12   381.80
                      MLO 2007  1   383.26
                      MLO 2007  2   384.42
                      MLO 2007  3   385.40
                      MLO 2007  4   386.49
                      MLO 2007  5   386.89
                      MLO 2007  6   386.31
                      MLO 2007  7   384.54
                      MLO 2007  8   381.65
                      MLO 2007  9   380.31
                      MLO 2007 10   381.16
                      MLO 2007 11   382.63
                      MLO 2007 12   384.06
                      MLO 2008  1   385.53
                      MLO 2008  2   385.71
                      MLO 2008  3   385.57
                      MLO 2008  4   387.05
                      MLO 2008  5   388.70
                      MLO 2008  6   388.46
                      MLO 2008  7   386.66
                      MLO 2008  8   384.24
                      MLO 2008  9   382.77
                      MLO 2008 10   382.91
                      MLO 2008 11   384.12
                      MLO 2008 12   385.66
                      MLO 2009  1   386.97
                      MLO 2009  2   387.71
                      MLO 2009  3   388.41
                      MLO 2009  4   389.34
                      MLO 2009  5   390.11
                      MLO 2009  6   389.52
                      MLO 2009  7   387.71
                      MLO 2009  8   385.84
                      MLO 2009  9   384.44
                      MLO 2009 10   384.60
                      MLO 2009 11   386.00
                      MLO 2009 12   387.51
                      MLO 2010  1   388.59
                      MLO 2010  2   389.72
                      MLO 2010  3   391.07
                      MLO 2010  4   392.60
                      MLO 2010  5   393.37
                      MLO 2010  6   392.25
                      MLO 2010  7   390.09
                      MLO 2010  8   388.00
                      MLO 2010  9   386.55
                      MLO 2010 10   387.21
                      MLO 2010 11   388.57
                      MLO 2010 12   390.06
                      MLO 2011  1   391.56
                      MLO 2011  2   392.14
                      MLO 2011  3   392.64
                      MLO 2011  4   393.69
                      MLO 2011  5   394.26
                      MLO 2011  6   393.80
                      MLO 2011  7   392.35
                      MLO 2011  8   389.96
                      MLO 2011  9   388.61
                      MLO 2011 10   389.16
                      MLO 2011 11   390.47
                      MLO 2011 12   392.17
                      MLO 2012  1   393.00
                      MLO 2012  2   393.25
                      MLO 2012  3   394.66
                      MLO 2012  4   396.56
                      MLO 2012  5   396.98
                      MLO 2012  6   395.86
                      MLO 2012  7   394.26
                      MLO 2012  8   392.19
                      MLO 2012  9   390.84
                      MLO 2012 10   391.11
                      MLO 2012 11   393.06
                      MLO 2012 12   394.64
                      MLO 2013  1   395.66
                      MLO 2013  2   396.80
                      MLO 2013  3   397.75
                      MLO 2013  4   398.70
                      MLO 2013  5   399.61
                      MLO 2013  6   399.15
                      MLO 2013  7   397.19
                      MLO 2013  8   395.01
                      MLO 2013  9   393.73
                      MLO 2013 10   393.87
                      MLO 2013 11   395.43
                      MLO 2013 12   397.03
                      MLO 2014  1   397.91
                      MLO 2014  2   398.33
                      MLO 2014  3   399.75
                      MLO 2014  4   401.64
                      MLO 2014  5   402.24
                      MLO 2014  6   401.39
                      MLO 2014  7   398.96
                      MLO 2014  8   396.52
                      MLO 2014  9   395.35
                      MLO 2014 10   395.67
                      MLO 2014 11   397.50
                      MLO 2014 12   399.26
                      MLO 2015  1   400.05
                      MLO 2015  2   400.38
                      MLO 2015  3   401.58
                      MLO 2015  4   403.68
                      MLO 2015  5   404.16
                      MLO 2015  6   402.92
                      MLO 2015  7   400.93
                      MLO 2015  8   398.90
                      MLO 2015  9   397.65
                      MLO 2015 10   398.23
                      MLO 2015 11   399.95
                      MLO 2015 12   401.53
                      MLO 2016  1   402.72
                      MLO 2016  2   403.62
                      MLO 2016  3   405.23
                      MLO 2016  4   407.35
                      MLO 2016  5   407.87
                      MLO 2016  6   406.57
                      MLO 2016  7   404.37
                      MLO 2016  8   401.69
                      MLO 2016  9   400.23
                      MLO 2016 10   401.47
                      MLO 2016 11   403.53
                      MLO 2016 12   404.66")

#Methane Data
# obtained at ftp://aftp.cmdl.noaa.gov/data/trace_gases/ch4/flask/surface/ch4_mlo_surface-flask_1_ccgg_month.txt
# in Feb 2018
maunaloa2<-read.table(header=TRUE,text="
                      where year month methane
                      MLO 1983  5  1639.23
                      MLO 1983  6  1633.53
                      MLO 1983  7  1633.19
                      MLO 1983  8  1631.38
                      MLO 1983  9  1648.43
                      MLO 1983 10  1663.75
                      MLO 1983 11  1658.22
                      MLO 1983 12  1654.33
                      MLO 1984  1  1658.97
                      MLO 1984  2  1656.47
                      MLO 1984  3  1655.76
                      MLO 1984  4  1657.71
                      MLO 1984  5  1649.33
                      MLO 1984  6  1633.93
                      MLO 1984  7  1629.71
                      MLO 1984  8  1643.76
                      MLO 1984  9  1663.31
                      MLO 1984 10  1673.72
                      MLO 1984 11  1676.09
                      MLO 1984 12  1671.23
                      MLO 1985  1  1662.44
                      MLO 1985  2  1665.22
                      MLO 1985  3  1677.36
                      MLO 1985  4  1674.26
                      MLO 1985  5  1665.95
                      MLO 1985  6  1658.63
                      MLO 1985  7  1653.49
                      MLO 1985  8  1653.73
                      MLO 1985  9  1667.63
                      MLO 1985 10  1680.79
                      MLO 1985 11  1679.95
                      MLO 1985 12  1677.30
                      MLO 1986  1  1675.09
                      MLO 1986  2  1666.10
                      MLO 1986  3  1672.14
                      MLO 1986  4  1687.78
                      MLO 1986  5  1685.33
                      MLO 1986  6  1684.31
                      MLO 1986  7  1682.00
                      MLO 1986  8  1669.87
                      MLO 1986  9  1679.75
                      MLO 1986 10  1690.42
                      MLO 1986 11  1691.76
                      MLO 1986 12  1697.38
                      MLO 1987  1  1692.00
                      MLO 1987  2  1689.67
                      MLO 1987  3  1694.41
                      MLO 1987  4  1695.58
                      MLO 1987  5  1694.19
                      MLO 1987  6  1687.17
                      MLO 1987  7  1680.59
                      MLO 1987  8  1678.21
                      MLO 1987  9  1681.06
                      MLO 1987 10  1700.84
                      MLO 1987 11  1715.96
                      MLO 1987 12  1707.57
                      MLO 1988  1  1697.68
                      MLO 1988  2  1700.56
                      MLO 1988  3  1705.48
                      MLO 1988  4  1707.58
                      MLO 1988  5  1705.13
                      MLO 1988  6  1698.45
                      MLO 1988  7  1687.25
                      MLO 1988  8  1691.20
                      MLO 1988  9  1700.78
                      MLO 1988 10  1708.26
                      MLO 1988 11  1719.26
                      MLO 1988 12  1725.77
                      MLO 1989  1  1720.86
                      MLO 1989  2  1712.63
                      MLO 1989  3  1715.06
                      MLO 1989  4  1723.47
                      MLO 1989  5  1724.35
                      MLO 1989  6  1713.17
                      MLO 1989  7  1699.86
                      MLO 1989  8  1706.65
                      MLO 1989  9  1720.84
                      MLO 1989 10  1721.99
                      MLO 1989 11  1726.19
                      MLO 1989 12  1730.72
                      MLO 1990  1  1727.94
                      MLO 1990  2  1728.47
                      MLO 1990  3  1733.87
                      MLO 1990  4  1737.55
                      MLO 1990  5  1734.57
                      MLO 1990  6  1722.31
                      MLO 1990  7  1712.70
                      MLO 1990  8  1718.02
                      MLO 1990  9  1733.91
                      MLO 1990 10  1736.92
                      MLO 1990 11  1741.48
                      MLO 1990 12  1749.67
                      MLO 1991  1  1734.88
                      MLO 1991  2  1731.02
                      MLO 1991  3  1746.57
                      MLO 1991  4  1749.61
                      MLO 1991  5  1747.34
                      MLO 1991  6  1740.02
                      MLO 1991  7  1730.94
                      MLO 1991  8  1722.04
                      MLO 1991  9  1734.65
                      MLO 1991 10  1751.77
                      MLO 1991 11  1750.32
                      MLO 1991 12  1752.46
                      MLO 1992  1  1755.62
                      MLO 1992  2  1750.06
                      MLO 1992  3  1752.44
                      MLO 1992  4  1753.30
                      MLO 1992  5  1744.58
                      MLO 1992  6  1743.34
                      MLO 1992  7  1736.29
                      MLO 1992  8  1725.76
                      MLO 1992  9  1729.88
                      MLO 1992 10  1740.78
                      MLO 1992 11  1755.35
                      MLO 1992 12  1758.41
                      MLO 1993  1  1747.88
                      MLO 1993  2  1745.69
                      MLO 1993  3  1748.00
                      MLO 1993  4  1746.77
                      MLO 1993  5  1749.61
                      MLO 1993  6  1745.59
                      MLO 1993  7  1731.93
                      MLO 1993  8  1732.02
                      MLO 1993  9  1744.57
                      MLO 1993 10  1760.24
                      MLO 1993 11  1768.05
                      MLO 1993 12  1763.59
                      MLO 1994  1  1759.89
                      MLO 1994  2  1752.11
                      MLO 1994  3  1754.68
                      MLO 1994  4  1763.82
                      MLO 1994  5  1755.15
                      MLO 1994  6  1746.67
                      MLO 1994  7  1737.43
                      MLO 1994  8  1734.00
                      MLO 1994  9  1757.24
                      MLO 1994 10  1778.62
                      MLO 1994 11  1781.15
                      MLO 1994 12  1779.38
                      MLO 1995  1  1764.55
                      MLO 1995  2  1757.10
                      MLO 1995  3  1764.86
                      MLO 1995  4  1762.96
                      MLO 1995  5  1762.21
                      MLO 1995  6  1759.23
                      MLO 1995  7  1749.37
                      MLO 1995  8  1751.18
                      MLO 1995  9  1761.52
                      MLO 1995 10  1768.91
                      MLO 1995 11  1768.32
                      MLO 1995 12  1773.02
                      MLO 1996  1  1771.38
                      MLO 1996  2  1770.46
                      MLO 1996  3  1769.92
                      MLO 1996  4  1759.12
                      MLO 1996  5  1755.04
                      MLO 1996  6  1753.80
                      MLO 1996  7  1747.19
                      MLO 1996  8  1745.61
                      MLO 1996  9  1767.21
                      MLO 1996 10  1774.69
                      MLO 1996 11  1769.96
                      MLO 1996 12  1773.12
                      MLO 1997  1  1769.96
                      MLO 1997  2  1768.67
                      MLO 1997  3  1775.66
                      MLO 1997  4  1780.66
                      MLO 1997  5  1776.62
                      MLO 1997  6  1768.26
                      MLO 1997  7  1751.54
                      MLO 1997  8  1750.35
                      MLO 1997  9  1775.74
                      MLO 1997 10  1784.89
                      MLO 1997 11  1784.07
                      MLO 1997 12  1783.30
                      MLO 1998  1  1772.27
                      MLO 1998  2  1766.13
                      MLO 1998  3  1774.66
                      MLO 1998  4  1780.43
                      MLO 1998  5  1781.20
                      MLO 1998  6  1779.11
                      MLO 1998  7  1762.53
                      MLO 1998  8  1757.23
                      MLO 1998  9  1771.19
                      MLO 1998 10  1787.42
                      MLO 1998 11  1798.38
                      MLO 1998 12  1803.08
                      MLO 1999  1  1796.37
                      MLO 1999  2  1784.76
                      MLO 1999  3  1788.19
                      MLO 1999  4  1788.42
                      MLO 1999  5  1773.25
                      MLO 1999  6  1771.20
                      MLO 1999  7  1767.00
                      MLO 1999  8  1768.66
                      MLO 1999  9  1785.91
                      MLO 1999 10  1794.49
                      MLO 1999 11  1796.52
                      MLO 1999 12  1801.93
                      MLO 2000  1  1802.08
                      MLO 2000  2  1793.84
                      MLO 2000  3  1791.95
                      MLO 2000  4  1786.89
                      MLO 2000  5  1773.88
                      MLO 2000  6  1772.35
                      MLO 2000  7  1769.46
                      MLO 2000  8  1762.08
                      MLO 2000  9  1773.90
                      MLO 2000 10  1796.96
                      MLO 2000 11  1798.68
                      MLO 2000 12  1790.80
                      MLO 2001  1  1789.20
                      MLO 2001  2  1793.33
                      MLO 2001  3  1801.05
                      MLO 2001  4  1797.36
                      MLO 2001  5  1783.16
                      MLO 2001  6  1773.35
                      MLO 2001  7  1769.25
                      MLO 2001  8  1764.68
                      MLO 2001  9  1779.92
                      MLO 2001 10  1790.89
                      MLO 2001 11  1793.03
                      MLO 2001 12  1796.09
                      MLO 2002  1  1787.42
                      MLO 2002  2  1782.86
                      MLO 2002  3  1786.15
                      MLO 2002  4  1781.95
                      MLO 2002  5  1778.33
                      MLO 2002  6  1774.58
                      MLO 2002  7  1766.41
                      MLO 2002  8  1766.10
                      MLO 2002  9  1780.44
                      MLO 2002 10  1795.45
                      MLO 2002 11  1801.15
                      MLO 2002 12  1792.65
                      MLO 2003  1  1785.94
                      MLO 2003  2  1791.76
                      MLO 2003  3  1796.92
                      MLO 2003  4  1794.97
                      MLO 2003  5  1786.89
                      MLO 2003  6  1790.58
                      MLO 2003  7  1785.33
                      MLO 2003  8  1773.06
                      MLO 2003  9  1788.25
                      MLO 2003 10  1806.05
                      MLO 2003 11  1807.61
                      MLO 2003 12  1794.57
                      MLO 2004  1  1789.81
                      MLO 2004  2  1797.91
                      MLO 2004  3  1806.94
                      MLO 2004  4  1805.52
                      MLO 2004  5  1787.75
                      MLO 2004  6  1779.82
                      MLO 2004  7  1774.59
                      MLO 2004  8  1769.80
                      MLO 2004  9  1778.21
                      MLO 2004 10  1790.72
                      MLO 2004 11  1800.49
                      MLO 2004 12  1796.73
                      MLO 2005  1  1788.48
                      MLO 2005  2  1796.08
                      MLO 2005  3  1802.82
                      MLO 2005  4  1791.30
                      MLO 2005  5  1780.86
                      MLO 2005  6  1780.05
                      MLO 2005  7  1771.32
                      MLO 2005  8  1766.46
                      MLO 2005  9  1787.27
                      MLO 2005 10  1806.12
                      MLO 2005 11  1803.11
                      MLO 2005 12  1798.37
                      MLO 2006  1  1794.46
                      MLO 2006  2  1785.84
                      MLO 2006  3  1786.21
                      MLO 2006  4  1800.64
                      MLO 2006  5  1798.33
                      MLO 2006  6  1779.65
                      MLO 2006  7  1765.36
                      MLO 2006  8  1762.14
                      MLO 2006  9  1775.52
                      MLO 2006 10  1788.46
                      MLO 2006 11  1791.44
                      MLO 2006 12  1794.62
                      MLO 2007  1  1799.19
                      MLO 2007  2  1802.60
                      MLO 2007  3  1802.63
                      MLO 2007  4  1801.65
                      MLO 2007  5  1795.23
                      MLO 2007  6  1781.34
                      MLO 2007  7  1771.38
                      MLO 2007  8  1778.95
                      MLO 2007  9  1793.78
                      MLO 2007 10  1801.88
                      MLO 2007 11  1803.32
                      MLO 2007 12  1805.15
                      MLO 2008  1  1809.46
                      MLO 2008  2  1802.99
                      MLO 2008  3  1792.38
                      MLO 2008  4  1792.12
                      MLO 2008  5  1796.01
                      MLO 2008  6  1791.32
                      MLO 2008  7  1782.40
                      MLO 2008  8  1779.41
                      MLO 2008  9  1794.58
                      MLO 2008 10  1813.66
                      MLO 2008 11  1811.90
                      MLO 2008 12  1812.40
                      MLO 2009  1  1816.16
                      MLO 2009  2  1814.73
                      MLO 2009  3  1815.28
                      MLO 2009  4  1807.06
                      MLO 2009  5  1802.72
                      MLO 2009  6  1806.24
                      MLO 2009  7  1794.25
                      MLO 2009  8  1788.09
                      MLO 2009  9  1801.87
                      MLO 2009 10  1811.50
                      MLO 2009 11  1814.68
                      MLO 2009 12  1815.55
                      MLO 2010  1  1810.92
                      MLO 2010  2  1817.87
                      MLO 2010  3  1821.24
                      MLO 2010  4  1818.01
                      MLO 2010  5  1816.50
                      MLO 2010  6  1803.08
                      MLO 2010  7  1793.50
                      MLO 2010  8  1800.61
                      MLO 2010  9  1810.57
                      MLO 2010 10  1826.33
                      MLO 2010 11  1830.53
                      MLO 2010 12  1821.20
                      MLO 2011  1  1823.70
                      MLO 2011  2  1819.68
                      MLO 2011  3  1815.48
                      MLO 2011  4  1816.01
                      MLO 2011  5  1811.52
                      MLO 2011  6  1810.25
                      MLO 2011  7  1803.09
                      MLO 2011  8  1799.91
                      MLO 2011  9  1813.09
                      MLO 2011 10  1823.80
                      MLO 2011 11  1827.44
                      MLO 2011 12  1831.82
                      MLO 2012  1  1827.56
                      MLO 2012  2  1819.24
                      MLO 2012  3  1824.07
                      MLO 2012  4  1834.90
                      MLO 2012  5  1829.55
                      MLO 2012  6  1814.01
                      MLO 2012  7  1803.91
                      MLO 2012  8  1803.99
                      MLO 2012  9  1815.80
                      MLO 2012 10  1828.91
                      MLO 2012 11  1836.46
                      MLO 2012 12  1836.27
                      MLO 2013  1  1833.35
                      MLO 2013  2  1836.92
                      MLO 2013  3  1838.80
                      MLO 2013  4  1830.36
                      MLO 2013  5  1825.20
                      MLO 2013  6  1814.80
                      MLO 2013  7  1804.80
                      MLO 2013  8  1813.64
                      MLO 2013  9  1838.16
                      MLO 2013 10  1844.51
                      MLO 2013 11  1840.42
                      MLO 2013 12  1848.10
                      MLO 2014  1  1840.72
                      MLO 2014  2  1831.02
                      MLO 2014  3  1847.06
                      MLO 2014  4  1855.57
                      MLO 2014  5  1844.18
                      MLO 2014  6  1831.50
                      MLO 2014  7  1818.96
                      MLO 2014  8  1824.29
                      MLO 2014  9  1841.04
                      MLO 2014 10  1844.03
                      MLO 2014 11  1854.77
                      MLO 2014 12  1863.90
                      MLO 2015  1  1853.42
                      MLO 2015  2  1848.67
                      MLO 2015  3  1858.38
                      MLO 2015  4  1866.30
                      MLO 2015  5  1862.18
                      MLO 2015  6  1844.58
                      MLO 2015  7  1831.99
                      MLO 2015  8  1827.55
                      MLO 2015  9  1840.39
                      MLO 2015 10  1860.36
                      MLO 2015 11  1866.15
                      MLO 2015 12  1863.49
                      MLO 2016  1  1858.25
                      MLO 2016  2  1858.33
                      MLO 2016  3  1864.58
                      MLO 2016  4  1873.36
                      MLO 2016  5  1870.71
                      MLO 2016  6  1855.71
                      MLO 2016  7  1835.76
                      MLO 2016  8  1840.68
                      MLO 2016  9  1863.21
                      MLO 2016 10  1876.06
                      MLO 2016 11  1874.51
                      MLO 2016 12  1864.68")

# merge datasets and clean up
climate<-merge(merge(newtemp,maunaloa1,by=c("year","month"),all.x=TRUE),maunaloa2,by=c("year","month"),all.x=TRUE)
climate<-subset(climate,!is.na(where.x) & !is.na(where.y) )
climate<-climate[,c("year","month","temp","co2","methane")]

#Data: accessed on 2/24/18
#Monthly Atmospheric N2O Concentration in ppb (1999–present):
#ftp://aftp.cmdl.noaa.gov/data/hats/n2o/insituGCs/CATS/monthly/mlo_N2O_MM.dat

maunaloa3<-read.table(header=TRUE,text="
                      year month n2o sd n
                      1999       7    315.16      0.33    546
                      1999       8    315.08      0.29    643
                      1999       9    315.08      0.27    473
                      1999      10    315.17      0.26    615
                      1999      11    315.46      0.28    569
                      1999      12    315.41      0.40    393
                      2000       1    315.54      0.40    544
                      2000       2    315.78      0.43    593
                      2000       3    315.70      0.39    732
                      2000       4    315.78      0.40    682
                      2000       5    315.75      0.39    642
                      2000       6    316.03      0.38    547
                      2000       7    316.18      0.37    565
                      2000       8    315.84      0.36    161
                      2000       9    316.91      0.55    209
                      2000      10    316.68      0.47    661
                      2000      11    316.95      0.87    129
                      2000      12    316.81      0.97    625
                      2001       1    316.79      1.09    417
                      2001       2    317.04      1.08    649
                      2001       3    317.01      1.18    727
                      2001       4    316.72      0.98    691
                      2001       5    316.82      0.85    738
                      2001       6    316.86      1.08    348
                      2001       7    316.80      0.82    635
                      2001       8    316.89      0.91    728
                      2001       9    316.96      0.91    708
                      2001      10    317.21      1.22    680
                      2001      11    317.27      1.27    642
                      2001      12    317.33      1.11    634
                      2002       1    317.50      1.02    671
                      2002       2    317.07      1.15    658
                      2002       3    317.41      1.31    645
                      2002       4    317.38      1.36    674
                      2002       5    317.89      1.14    281
                      2002       6     nan        nan       0
                      2002       7     nan        nan       0
                      2002       8     nan        nan       0
                      2002       9    317.55      0.61    142
                      2002      10    317.72      0.47    678
                      2002      11    317.81      0.44    671
                      2002      12    317.76      0.37    692
                      2003       1    317.91      0.33    668
                      2003       2    317.79      0.23    638
                      2003       3    318.05      0.34    735
                      2003       4    318.06      0.38    696
                      2003       5    318.17      0.34    724
                      2003       6    318.17      0.37    693
                      2003       7    318.29      0.39    686
                      2003       8    318.33      0.45    693
                      2003       9    318.53      0.44    662
                      2003      10    318.60      0.47    688
                      2003      11    318.61      0.33    693
                      2003      12    318.63      0.36    729
                      2004       1    318.76      0.35    727
                      2004       2    318.68      0.42    651
                      2004       3    318.64      0.34    656
                      2004       4    318.74      0.35    708
                      2004       5    318.85      0.35    695
                      2004       6    318.90      0.34    682
                      2004       7    318.94      0.37    631
                      2004       8    319.02      0.49    581
                      2004       9    319.10      0.51    641
                      2004      10    319.20      0.39    699
                      2004      11    319.33      0.37    701
                      2004      12    319.34      0.38    676
                      2005       1    319.46      0.38    646
                      2005       2    319.53      0.31    637
                      2005       3    319.56      0.37    704
                      2005       4    319.55      0.35    685
                      2005       5    319.63      0.31    700
                      2005       6    319.66      0.33    671
                      2005       7    319.83      0.29    690
                      2005       8    319.99      0.48    697
                      2005       9    319.79      0.50    678
                      2005      10    319.89      0.63    725
                      2005      11    319.91      0.52    696
                      2005      12    320.17      0.41    592
                      2006       1    320.21      0.44    692
                      2006       2    320.15      0.42    593
                      2006       3    320.05      0.39    716
                      2006       4    320.29      0.42    692
                      2006       5    320.27      0.38    693
                      2006       6    320.41      0.38    653
                      2006       7    320.42      1.82    244
                      2006       8    320.45      0.46    124
                      2006       9    320.49      0.42    522
                      2006      10    320.74      0.43    613
                      2006      11    320.75      0.40    674
                      2006      12    320.96      0.54    672
                      2007       1    320.96      0.53    690
                      2007       2    321.06      0.48    641
                      2007       3    320.96      0.43    709
                      2007       4    321.25      0.52    667
                      2007       5    321.19      0.52    692
                      2007       6    321.29      0.42    687
                      2007       7    321.32      0.44    692
                      2007       8    321.42      0.62    581
                      2007       9    321.40      0.54    677
                      2007      10    321.50      0.45    679
                      2007      11    321.70      0.53    590
                      2007      12    321.78      0.61    643
                      2008       1    322.02      0.57    422
                      2008       2    321.89      0.42     70
                      2008       3    321.88      0.41    726
                      2008       4    322.06      0.31    713
                      2008       5    322.01      0.33    713
                      2008       6    322.10      0.31    700
                      2008       7    322.27      0.28    732
                      2008       8    322.27      0.30    732
                      2008       9    322.36      0.32    706
                      2008      10    322.60      0.35    701
                      2008      11    322.60      0.34    701
                      2008      12    322.63      0.35    701
                      2009       1    322.74      0.36    560
                      2009       2    322.68      0.28    667
                      2009       3    322.72      0.29    720
                      2009       4    322.75      0.30    711
                      2009       5    322.87      0.31    728
                      2009       6    322.92      0.32    699
                      2009       7    322.85      0.31    733
                      2009       8    322.96      0.26    743
                      2009       9    323.09      0.28    719
                      2009      10    323.10      0.27    738
                      2009      11    323.21      0.26    707
                      2009      12    323.35      0.26    738
                      2010       1    323.45      0.49    686
                      2010       2    323.18      0.78    314
                      2010       3     nan        nan       0
                      2010       4    323.57      0.33    688
                      2010       5    323.69      0.35    706
                      2010       6    323.68      0.35    690
                      2010       7    323.68      0.32    726
                      2010       8    323.83      0.32    618
                      2010       9    323.86      0.31    582
                      2010      10    324.17      0.33    742
                      2010      11    324.30      0.35    703
                      2010      12    324.44      0.34    684
                      2011       1    324.37      0.40    571
                      2011       2    324.44      0.37    653
                      2011       3    324.47      0.41    736
                      2011       4    324.49      0.45    613
                      2011       5    324.44      0.40    734
                      2011       6    324.51      0.42    659
                      2011       7    324.65      0.34    734
                      2011       8    324.82      0.28    736
                      2011       9    324.91      0.30    717
                      2011      10    325.06      0.31    739
                      2011      11    325.14      0.25    683
                      2011      12    325.27      0.29    735
                      2012       1    325.46      0.32    742
                      2012       2    325.47      0.42    682
                      2012       3    325.34      0.34    584
                      2012       4    325.47      0.33    715
                      2012       5    325.40      0.37    713
                      2012       6    325.37      0.31    683
                      2012       7    325.43      0.33    741
                      2012       8    325.55      0.34    724
                      2012       9    325.67      0.57    683
                      2012      10    325.94      0.67    702
                      2012      11    325.95      0.57    675
                      2012      12    326.05      0.28    735
                      2013       1    326.09      0.27    734
                      2013       2    326.15      0.29    627
                      2013       3    326.17      0.26    741
                      2013       4    326.27      0.26    709
                      2013       5    326.43      0.28    712
                      2013       6    326.35      0.33    715
                      2013       7    326.38      0.33    683
                      2013       8    326.65      0.35    431
                      2013       9    326.67      0.32    696
                      2013      10    326.70      0.30    732
                      2013      11    326.87      0.29    711
                      2013      12    326.93      0.31    734
                      2014       1    327.03      0.30    731
                      2014       2    327.12      0.29    665
                      2014       3    327.17      0.35    699
                      2014       4    327.15      0.37    699
                      2014       5    327.50      0.32    658
                      2014       6    327.51      0.33    694
                      2014       7    327.63      0.52    644
                      2014       8    327.74      0.59    582
                      2014       9    328.22      0.62    549
                      2014      10    328.48      0.50    480
                      2014      11    328.37      0.37    554
                      2014      12    328.36      0.33    517
                      2015       1    328.43      0.38    553
                      2015       2    328.40      0.37    528
                      2015       3    328.42      0.48    562
                      2015       4    328.61      0.34    511
                      2015       5    328.65      0.42    565
                      2015       6    328.47      0.35    510
                      2015       7    328.62      0.34    573
                      2015       8    328.90      0.52    522
                      2015       9    329.10      0.29    690
                      2015      10    329.25      0.28    715
                      2015      11    329.29      0.26    697
                      2015      12    329.29      0.24    633
                      2016       1    329.40      0.23    730
                      2016       2    329.32      0.25    674
                      2016       3    329.31      0.26    614
                      2016       4    329.37      0.31    671
                      2016       5    329.37      0.30    711
                      2016       6    329.30      0.36    681
                      2016       7    329.38      0.36    731
                      2016       8    329.53      0.36    689
                      2016       9    329.73      0.35    635
                      2016      10    329.87      0.51    636
                      2016      11    329.88      0.47    682
                      2016      12    329.74      0.47    664
                      2017       1    329.89      0.48    668
                      2017       2    329.83      0.49    655
                      2017       3    329.89      0.66    704
                      2017       4    329.75      0.83    665
                      2017       5    329.82      0.67    706
                      2017       6    329.84      0.94    679
                      2017       7    329.84      0.68    523
                      2017       8    329.98      0.71    707
                      2017       9    329.92      0.52    704
                      2017      10    330.02      0.53    704
                      2017      11    330.01      0.53    702
                      2017      12    330.11      0.59    700
                      2018       1    329.98      0.52    214")
maunaloa3<-maunaloa3[,1:3]

#Monthly Atmospheric Sulfur Hexaflouride (SF6) Concentration in ppt (1999–present):
#ftp://aftp.cmdl.noaa.gov/data/hats/sf6/insituGCs/CATS/monthly/mlo_SF6_MM.dat

maunaloa4<-read.table(header=TRUE,text="
year month hcfc sd n
1999       1     10.84      0.50    636
                      1999       2     10.84      0.38     70
                      1999       3     11.16      0.47    518
                      1999       4     11.80      0.45    153
                      1999       5     11.68      0.37    590
                      1999       6     11.69      0.46    529
                      1999       7     10.90      0.56    621
                      1999       8     10.99      0.55    423
                      1999       9     11.46      0.40    306
                      1999      10     11.36      0.47    573
                      1999      11     11.60      0.48    572
                      1999      12     11.90      0.72    408
                      2000       1     11.87      0.83    591
                      2000       2     11.56      0.76    616
                      2000       3     11.74      0.83    741
                      2000       4     11.92      0.86    691
                      2000       5     11.77      0.82    668
                      2000       6     12.03      0.87    570
                      2000       7     12.05      0.81    590
                      2000       8     12.26      0.76    163
                      2000       9     12.30      0.83    320
                      2000      10     12.51      1.03    697
                      2000      11     12.57      1.13    346
                      2000      12     12.61      1.13    644
                      2001       1     12.86      0.99    454
                      2001       2     12.72      1.15    656
                      2001       3     12.75      1.18    736
                      2001       4     12.74      1.22    707
                      2001       5     12.70      1.13    737
                      2001       6     12.65      1.25    349
                      2001       7     13.02      1.22    112
                      2001       8     12.36      1.08    165
                      2001       9     13.22      1.00    319
                      2001      10     13.30      0.78    739
                      2001      11     13.36      0.77    417
                      2001      12     12.93      0.83    144
                      2002       1     13.01      0.92    115
                      2002       2     13.31      0.93    390
                      2002       3     13.37      0.77    732
                      2002       4     13.33      0.83    697
                      2002       5     13.43      0.83    703
                      2002       6     13.66      0.85    709
                      2002       7     13.37      0.90    683
                      2002       8     13.93      0.99    175
                      2002       9     nan        nan       0
                      2002      10     nan        nan       0
                      2002      11     nan        nan       0
                      2002      12     nan        nan       0
                      2003       1     nan        nan       0
                      2003       2     13.79      2.81     33
                      2003       3     13.18      2.16    555
                      2003       4     12.55      2.81     29
                      2003       5     nan        nan       0
                      2003       6     13.94      1.61    123
                      2003       7     14.55      1.80    249
                      2003       8     14.42      1.09    515
                      2003       9     14.58      0.78    635
                      2003      10     14.67      0.76    240
                      2003      11     14.89      0.74    523
                      2003      12     14.79      0.85    733
                      2004       1     14.27      0.76    732
                      2004       2     14.50      0.81    677
                      2004       3     14.56      0.82    675
                      2004       4     14.82      0.81    704
                      2004       5     14.68      0.81    689
                      2004       6     14.70      0.95    655
                      2004       7     14.76      0.85    651
                      2004       8     14.84      0.79    602
                      2004       9     15.12      0.78    623
                      2004      10     15.23      0.80    713
                      2004      11     15.17      0.88    715
                      2004      12     15.08      0.82    685
                      2005       1     15.17      0.84    663
                      2005       2     15.13      0.85    634
                      2005       3     15.30      0.81    708
                      2005       4     15.06      0.85    551
                      2005       5     15.19      0.92    491
                      2005       6     15.36      0.81    185
                      2005       7     15.35      0.97    451
                      2005       8     15.68      1.08    392
                      2005       9     15.83      0.76    444
                      2005      10     16.06      0.78    394
                      2005      11     nan        nan       0
                      2005      12     nan        nan       0
                      2006       1     nan        nan       0
                      2006       2     nan        nan       0
                      2006       3     nan        nan       0
                      2006       4     16.51      0.82    142
                      2006       5     16.66      0.86    699
                      2006       6     16.51      1.01    674
                      2006       7     16.55      1.00    673
                      2006       8     16.48      0.95    709
                      2006       9     16.79      0.88    532
                      2006      10     17.01      0.88    616
                      2006      11     17.20      1.04    686
                      2006      12     17.26      1.15    708
                      2007       1     17.44      1.88    678
                      2007       2     16.66      2.67    541
                      2007       3     17.32      2.52    672
                      2007       4     17.53      2.17    647
                      2007       5     16.82      3.23    342
                      2007       6     17.27      1.87    169
                      2007       7     17.39      1.77    215
                      2007       8     17.86      1.94    585
                      2007       9     18.25      2.21    591
                      2007      10     18.17      2.66    576
                      2007      11     17.95      1.25    350
                      2007      12     18.18      0.53    700
                      2008       1     19.13      0.63    417
                      2008       2     nan        nan       0
                      2008       3     nan        nan       0
                      2008       4     nan        nan       0
                      2008       5     nan        nan       0
                      2008       6     18.29      1.77    639
                      2008       7     19.41      2.01    672
                      2008       8     19.42      1.52    689
                      2008       9     19.20      1.83    667
                      2008      10     19.56      1.27    418
                      2008      11     19.84      0.94    463
                      2008      12     19.70      1.00    655
                      2009       1     20.34      1.00    706
                      2009       2     20.96      0.92    668
                      2009       3     20.97      0.99    663
                      2009       4     21.00      1.02    710
                      2009       5     21.14      0.98    717
                      2009       6     20.64      0.96    702
                      2009       7     19.97      1.10    725
                      2009       8     20.25      1.00    663
                      2009       9     20.21      1.24    719
                      2009      10     20.83      1.26    731
                      2009      11     20.29      1.24    705
                      2009      12     20.25      1.60    713
                      2010       1     19.76      1.66    715
                      2010       2     20.24      1.79    659
                      2010       3     19.82      2.16    686
                      2010       4     19.94      2.45    558
                      2010       5     20.60      2.85    354
                      2010       6     20.23      1.22    671
                      2010       7     21.00      1.13    723
                      2010       8     20.87      1.05    635
                      2010       9     21.19      1.02    560
                      2010      10     21.35      1.08    722
                      2010      11     21.27      0.91    702
                      2010      12     21.04      0.81    685
                      2011       1     20.99      0.86    583
                      2011       2     20.82      0.94    663
                      2011       3     20.98      1.03    717
                      2011       4     20.78      1.10    704
                      2011       5     21.03      1.03    658
                      2011       6     21.01      1.16    595
                      2011       7     20.92      1.35    730
                      2011       8     20.96      1.55    740
                      2011       9     21.06      1.57    623
                      2011      10     21.54      1.45    733
                      2011      11     21.36      1.53    706
                      2011      12     21.15      1.61    729
                      2012       1     21.80      1.73    727
                      2012       2     21.21      1.48    622
                      2012       3     21.33      1.23    549
                      2012       4     21.23      1.42    705
                      2012       5     21.69      1.33    716
                      2012       6     21.55      1.44    671
                      2012       7     21.48      1.66    686
                      2012       8     21.72      1.70    685
                      2012       9     22.05      1.66    649
                      2012      10     21.95      1.61    578
                      2012      11     22.20      1.25    713
                      2012      12     21.76      1.29    728
                      2013       1     21.83      1.07    654
                      2013       2     21.50      1.04    651
                      2013       3     21.78      1.02    706
                      2013       4     21.90      1.24    707
                      2013       5     22.30      1.66    713
                      2013       6     22.04      1.49    697
                      2013       7     22.14      1.32    679
                      2013       8     22.15      1.70    518
                      2013       9     22.29      2.02    645
                      2013      10     22.43      1.48    521
                      2013      11     21.99      1.33    663
                      2013      12     22.36      1.34    711
                      2014       1     22.04      1.09    730
                      2014       2     21.69      1.12    603
                      2014       3     22.22      1.17    698
                      2014       4     22.79      1.16    705
                      2014       5     22.35      1.19    657
                      2014       6     23.32      1.19    676
                      2014       7     23.08      0.93    712
                      2014       8     23.24      0.71    612
                      2014       9     23.37      0.74    709
                      2014      10     23.11      0.66    629
                      2014      11     23.50      0.72    696
                      2014      12     23.57      0.59    669
                      2015       1     23.21      0.66    720
                      2015       2     23.09      0.68    666
                      2015       3     23.30      0.59    727
                      2015       4     23.50      0.67    703
                      2015       5     23.17      0.71    709
                      2015       6     22.85      0.76    660
                      2015       7     22.42      0.70    729
                      2015       8     22.15      0.72    678
                      2015       9     22.41      0.89    695
                      2015      10     22.79      1.02    731
                      2015      11     22.67      1.09    719
                      2015      12     21.98      0.85    608
                      2016       1     22.10      0.97    717
                      2016       2     22.15      0.92    677
                      2016       3     21.10      0.87    584
                      2016       4     21.80      1.12    680
                      2016       5     22.05      0.87    721
                      2016       6     22.63      0.66    711
                      2016       7     22.44      0.68    731
                      2016       8     22.63      0.57    693
                      2016       9     23.02      0.55    679
                      2016      10     23.19      0.66    731
                      2016      11     23.25      0.66    715
                      2016      12     23.18      0.71    142
                      2017       1     nan        nan       0
                      2017       2     22.75      0.54    666
                      2017       3     22.47      0.54    645
                      2017       4     22.63      0.58    708
                      2017       5     22.74      0.39    713
                      2017       6     22.58      0.42    684
                      2017       7     22.53      0.48    433
                      2017       8     nan        nan       0
                      2017       9     nan        nan       0
                      2017      10     nan        nan       0
                      2017      11     nan        nan       0
                      2017      12     nan        nan       0
                      2018       1     nan        nan       0")
maunaloa4<-maunaloa4[,1:3]

#Monthly Atmospheric Sulfur Hexaflouride (SF6) Concentration in ppt (1999–present):
 # ftp://aftp.cmdl.noaa.gov/data/hats/sf6/insituGCs/CATS/monthly/mlo_SF6_MM.dat
maunaloa5<-read.table(header=TRUE,text="
year month sf6 sd n
                      1999       7     4.427     0.058    558
                      1999       8     4.437     0.058    586
                      1999       9     4.501     0.039    482
                      1999      10     4.504     0.035    629
                      1999      11     4.534     0.052    324
                      1999      12     4.573     0.054    314
                      2000       1     nan        nan       0
                      2000       2     4.565     0.127    440
                      2000       3     4.578     0.159    550
                      2000       4     4.625     0.056    555
                      2000       5     4.604     0.080    656
                      2000       6     4.660     0.067    546
                      2000       7     4.665     0.056    581
                      2000       8     4.684     0.076    158
                      2000       9     4.730     0.055    207
                      2000      10     4.737     0.067    678
                      2000      11     4.652     0.168     76
                      2000      12     4.748     0.168    526
                      2001       1     4.781     0.111    428
                      2001       2     4.807     0.093    621
                      2001       3     4.817     0.109    700
                      2001       4     4.849     0.062    691
                      2001       5     4.856     0.046    738
                      2001       6     4.839     0.069    349
                      2001       7     4.879     0.112    640
                      2001       8     4.862     0.140    729
                      2001       9     4.909     0.162    707
                      2001      10     4.935     0.136    641
                      2001      11     4.962     0.157    645
                      2001      12     4.941     0.205    622
                      2002       1     4.972     0.221    654
                      2002       2     4.955     0.125    659
                      2002       3     5.054     0.242    577
                      2002       4     5.079     0.230    689
                      2002       5     4.972     0.175    282
                      2002       6     nan        nan       0
                      2002       7     nan        nan       0
                      2002       8     nan        nan       0
                      2002       9     5.124     0.056    136
                      2002      10     5.140     0.036    722
                      2002      11     5.165     0.037    689
                      2002      12     5.170     0.033    717
                      2003       1     5.184     0.042    590
                      2003       2     5.167     0.049     24
                      2003       3     5.205     0.062    739
                      2003       4     5.250     0.070    702
                      2003       5     5.239     0.060    739
                      2003       6     5.274     0.060    702
                      2003       7     5.272     0.059    686
                      2003       8     5.281     0.064    705
                      2003       9     5.332     0.061    666
                      2003      10     5.338     0.061    700
                      2003      11     5.367     0.059    695
                      2003      12     5.377     0.059    737
                      2004       1     5.350     0.060    732
                      2004       2     5.376     0.058    666
                      2004       3     5.394     0.057    677
                      2004       4     5.445     0.067    716
                      2004       5     5.467     0.073    682
                      2004       6     5.493     0.064    686
                      2004       7     5.530     0.069    647
                      2004       8     5.499     0.067    603
                      2004       9     5.557     0.068    669
                      2004      10     5.561     0.074    700
                      2004      11     5.602     0.066    715
                      2004      12     5.594     0.064    684
                      2005       1     5.605     0.062    660
                      2005       2     5.638     0.068    645
                      2005       3     5.682     0.068    711
                      2005       4     5.676     0.066    691
                      2005       5     5.688     0.086    704
                      2005       6     5.724     0.078    681
                      2005       7     5.713     0.085    712
                      2005       8     5.727     0.074    717
                      2005       9     5.754     0.049    713
                      2005      10     5.774     0.043    732
                      2005      11     5.782     0.042    719
                      2005      12     5.831     0.055    602
                      2006       1     5.858     0.066    708
                      2006       2     5.876     0.076    608
                      2006       3     5.886     0.068    716
                      2006       4     5.961     0.069    700
                      2006       5     5.963     0.076    700
                      2006       6     5.970     0.071    654
                      2006       7     5.966     0.071    670
                      2006       8     5.973     0.082    674
                      2006       9     6.016     0.061    532
                      2006      10     6.038     0.067    621
                      2006      11     6.052     0.081    665
                      2006      12     6.114     0.079    683
                      2007       1     6.125     0.073    698
                      2007       2     6.148     0.066    646
                      2007       3     6.108     0.052    417
                      2007       4     nan        nan       0
                      2007       5     6.175     0.059    624
                      2007       6     6.207     0.057    688
                      2007       7     6.218     0.060    700
                      2007       8     6.275     0.070    599
                      2007       9     6.278     0.061    690
                      2007      10     6.336     0.056    693
                      2007      11     6.336     0.050    616
                      2007      12     6.352     0.051    701
                      2008       1     6.392     0.053    491
                      2008       2     6.341     0.022     70
                      2008       3     6.382     0.023    732
                      2008       4     6.423     0.023    718
                      2008       5     6.477     0.025    728
                      2008       6     6.494     0.026    710
                      2008       7     6.500     0.026    743
                      2008       8     6.518     0.027    732
                      2008       9     6.527     0.027    717
                      2008      10     6.603     0.026    728
                      2008      11     6.608     0.025    707
                      2008      12     6.617     0.024    741
                      2009       1     6.647     0.026    726
                      2009       2     6.664     0.027    667
                      2009       3     6.716     0.038    735
                      2009       4     6.728     0.045    715
                      2009       5     6.740     0.044    739
                      2009       6     6.766     0.046    709
                      2009       7     6.751     0.042    743
                      2009       8     6.758     0.045    743
                      2009       9     6.817     0.043    719
                      2009      10     6.850     0.044    742
                      2009      11     6.885     0.042    719
                      2009      12     6.847     0.045    414
                      2010       1     6.969     0.081    307
                      2010       2     6.970     0.052    672
                      2010       3     7.005     0.051    738
                      2010       4     7.002     0.053    708
                      2010       5     7.061     0.058    732
                      2010       6     7.125     0.052    709
                      2010       7     7.154     0.054    723
                      2010       8     7.153     0.058    637
                      2010       9     7.217     0.047    591
                      2010      10     7.263     0.042    742
                      2010      11     7.275     0.042    715
                      2010      12     7.244     0.041    692
                      2011       1     7.284     0.045    585
                      2011       2     7.300     0.044    671
                      2011       3     7.294     0.089    719
                      2011       4     7.322     0.107    606
                      2011       5     7.383     0.042    743
                      2011       6     7.402     0.048    676
                      2011       7     7.426     0.050    742
                      2011       8     7.424     0.052    742
                      2011       9     7.482     0.050    709
                      2011      10     7.538     0.049    739
                      2011      11     7.527     0.053    682
                      2011      12     7.541     0.038    743
                      2012       1     7.573     0.043    688
                      2012       2     7.579     0.086    695
                      2012       3     7.609     0.049    609
                      2012       4     7.645     0.039    719
                      2012       5     7.661     0.035    729
                      2012       6     7.659     0.031    693
                      2012       7     7.646     0.033    741
                      2012       8     7.673     0.033    737
                      2012       9     7.727     0.029    696
                      2012      10     7.738     0.030    720
                      2012      11     7.819     0.035    719
                      2012      12     7.811     0.031    735
                      2013       1     7.817     0.031    740
                      2013       2     7.886     0.036    326
                      2013       3     7.881     0.036    741
                      2013       4     7.934     0.039    715
                      2013       5     8.034     0.038    728
                      2013       6     8.010     0.043    719
                      2013       7     8.040     0.042    686
                      2013       8     8.096     0.039    432
                      2013       9     8.151     0.033    701
                      2013      10     8.140     0.032    733
                      2013      11     8.139     0.034    719
                      2013      12     8.196     0.034    742
                      2014       1     8.189     0.032    735
                      2014       2     8.183     0.031    671
                      2014       3     8.263     0.030    711
                      2014       4     8.320     0.032    719
                      2014       5     8.314     0.033    668
                      2014       6     8.361     0.034    708
                      2014       7     8.344     0.034    670
                      2014       8     8.387     0.028    595
                      2014       9     8.457     0.028    670
                      2014      10     8.468     0.025    620
                      2014      11     8.484     0.021    706
                      2014      12     8.497     0.023    663
                      2015       1     8.494     0.027    730
                      2015       2     8.487     0.027    658
                      2015       3     8.524     0.030    716
                      2015       4     8.609     0.027    690
                      2015       5     8.644     0.033    728
                      2015       6     8.629     0.028    656
                      2015       7     8.632     0.027    730
                      2015       8     8.603     0.032    659
                      2015       9     8.775     0.032    699
                      2015      10     8.797     0.030    732
                      2015      11     8.843     0.030    711
                      2015      12     8.871     0.037    675
                      2016       1     8.840     0.037    734
                      2016       2     8.885     0.042    690
                      2016       3     8.891     0.044    611
                      2016       4     8.996     0.040    706
                      2016       5     9.006     0.042    735
                      2016       6     9.029     0.045    707
                      2016       7     8.998     0.052    743
                      2016       8     9.004     0.049    713
                      2016       9     9.062     0.080    673
                      2016      10     9.124     0.094    676
                      2016      11     9.195     0.069    711
                      2016      12     9.132     0.067    684
                      2017       1     9.191     0.077    687
                      2017       2     9.179     0.069    651
                      2017       3     9.181     0.072    713
                      2017       4     9.272     0.077    707
                      2017       5     9.305     0.069    717
                      2017       6     9.330     0.069    685
                      2017       7     9.352     0.072    544
                      2017       8     9.396     0.061    721
                      2017       9     9.477     0.058    716
                      2017      10     9.504     0.066    728
                      2017      11     9.525     0.065    714
                      2017      12     9.541     0.057    722
                      2018       1     9.548     0.067    214")
maunaloa5<-maunaloa5[,1:3]

# merge additional datasets and clean up
climate<-merge(climate,maunaloa3,by=c("year","month"),all.x=TRUE)
climate<-subset(climate,!is.na(n2o))
climate<-merge(climate,maunaloa4,by=c("year","month"),all.x=TRUE)
climate<-subset(climate,!is.na(hcfc))
climate<-merge(climate,maunaloa5,by=c("year","month"),all.x=TRUE)
climate<-subset(climate,!is.na(sf6))
# with so many observations removed for missing data, renumber the rows
rownames(climate)<-1:dim(climate)[1]

head (climate)

#EDA:
#The correlation of of temp and co2, methane, n2o, hcfc, and sf6 are respectively
cor(climate$temp, climate[,4:8])

#Analysis:

#Our response variable is temperature, our explanatory variables are the amounts of Methane, N2O, HCFC, CO2, and SF6
#in the atmosphere. 

#Model: temp = beta0 + beta1*CO2 + beta2*methane + beta3*n20 + beta4*hcfc + beta5*sf6 + epsilon, 
# where epsilon ~N(0, sigma2)

out2.climate <- lm(temp~co2+methane+n2o + hcfc + sf6, data=climate)
summary(out2.climate)
# It is odd that hcfc and sf6 have the "wrong sign" from correlation coefficient, and hcfc is
# statistically significant

#Possible Problems:
#data source/ location
#merging lost us the early data
#bad influential observations and outliers
#collinearity

#to compare our observational study to a designed experiment, plot the explanatory variables 
#versus one another
plot(~co2+methane+n2o + hcfc + sf6, data=climate)
#This graphic is scary because there are giant gaps in the data. We hoped to see a bunch a
#squares, but we see a bunch of linear scatterplots. We want to see every possible combination,
# or all the combinations of possible factors, but we only have explored small linear portions of the 
# combinations. 

# Collinearity is a near linear relationship between explanatory variables. Bad!
# recall that beta.hat = (x'x)-1x'y if x'x is non singular. If there is collinearity, then x'x 
# will be almost singular, meaning our beta.hat formula won't give us what we expect. 

#Here's what might happen:
# opposite correlation coefficient sign that what we expect
# se(beta.hat) are inflected
# non significant H0: Beta.hat = 0 for cases where we expect significance.

#Collinearity Diagnostics: VIF (Variance Inflation Factor, when compared to a designed experiment)
#Rule of Thumb, is VIF > 10, then no go. 
library(car)
vif(out2.climate)

#Throw out n20 bc of collinearilty prob
out.n20 <- lm(temp~co2+methane + hcfc + sf6, data=climate)
plot(~co2+methane + hcfc + sf6, data=climate)
vif(out.n20)

#Throw out sf6 too
out.sf6 <- lm(temp~co2+methane + hcfc, data=climate)
plot(~co2+methane + hcfc, data=climate)
vif(out.sf6)

#Still not great. Maybe we'll throw out some outliers.
plot(climate$hcfc, climate$temp)
rsf6 <- rstudent(out.sf6)
subset(rsf6, abs(rsf6) >= 2)
hist(rsf6)


climate2 <- climate[-c(32,54,76,87,178,182,183),]
out.climate2 <- lm(temp~co2+methane + hcfc, data=climate2)
summary(out.climate2)

#Even after throwing out N20 and SF6, as well as getting rid of some of the outliers, our model still has a 
#negative hcfc coef. I think we still have collinearity prob, and that my analysis will be no good unless I take 
#further action, drastic though it seem, of getting rid of the CO2 variable as well. And since our explanatory 
#variables are so closely related, even though we are taking CO2, N2O, and SF6 out of the model, they are still
#represented in a way, because as HCFC and methane go up, so do CO2, N2O, and SF6. 

#Model
out.co2 <- lm(temp~methane + hcfc, data=climate)

#Check for Collinearity Prob. We're good. 
plot(~methane + hcfc, data=climate)
vif(out.co2)

#R Studentized Residuals
r.outco2 <- rstudent(out.co2)
subset(r.outco2, abs(r.outco2) >= 2)
hist(r.outco2)
#Luckily, this histogram of the residuals does look normal. However, some of the values are a little too far out in
#the tail to be comfortable. We should get rid of some of the most extreme values.

#Leverage
leverage.climate <- lm.influence(out.co2)$hat
cut <- 6/189
subset(leverage.climate, leverage.climate > cut)

#Cook's Distance
lim <- 4/(189-(2+1))
cd.outco2 <- cooks.distance(out.co2)
subset(cd.outco2, cd.outco2 >= lim)


#Which ones should I throw out, looking at rstudent, leverage, and cd?

#By looking at the residuals...
#I feel pretty good about throwing out 7, 32, 76, and 87 because they are singular way out data points whose neighbors
#are nowhere near them. I'm going to keep the outlier in the 170's - 180's range because those are our most recent 
#data. It would probably be a bad idea to throw out the consistent current conditions. 

#By examining the leverage and the cook's distance, 
#Observation 2 and 74 were both above the threshold on both, so we'll look at the graph to see where they stand.

#Observation 2
par(mfrow=c(1,2))
plot(climate$methane, climate$temp, col=ifelse(climate$year == 1999 & climate$month == 11, "red", "black"))
plot(climate$hcfc, climate$temp, col=ifelse(climate$year == 1999 & climate$month == 11, "red", "black"))
#Observation 74
plot(climate$methane, climate$temp, col=ifelse(climate$year == 2000 & climate$month == 10, "red", "black"))
plot(climate$hcfc, climate$temp, col=ifelse(climate$year == 2000 & climate$month == 10, "red", "black"))

# I was surprised that obs 2 qualified as an influential observation. it didn't look very influential to me. We'll
# keep it. Observation 7 however, was going down when the rest of the data was going up in the methane plot. Because
# of that we'll call it a bad influential observation and throw it out. 

climate.trim <- climate[-c(7,32,74,76,87),]
out.co2.trim <- lm(temp~methane + hcfc, data=climate.trim)
summary(out.co2.trim)

#I fit the model using only the HCFC and Methane explanatory variables. I felt that the collinearity problem was
#too big to provide accurate results. I'm not too worried about throwing them out, however, because methane and
#hcfc also predict the other variables, since they are linearly correlated. I also tossed out a few data points that
#I felt were too large a residual, or in one case, was a bad influential observation. The number of data points total
#thrown out was only 5. Because of this choice of model, I now have a positive beta for hcfc, which is what we 
#expected to see. However, I am not taking into account all the information and data that I have available, which
#is a bummer. 

#Research Task: Fit a model to predict the effect of greenhouse gases on the earth's temperature.
#Data Features: The data is linear, so it fit the model without having to perform any transformations.

#Weaknesses: The collinearity of the explanatory variables proved to be a biggish problem. Maybe it would have
#been better to use other variables that weren't so collinear. 

#Challenge: The moneyball problem!! Which characteristics are the most important for players to score homeruns
# and therefore for baseball teams to win on a low budget. Data can be acquired from the MLb website. 












